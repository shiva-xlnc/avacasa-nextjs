(()=>{var e={};e.id=7679,e.ids=[7679],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6203:(e,s,a)=>{Promise.resolve().then(a.bind(a,22727))},7066:e=>{"use strict";e.exports=require("node:tty")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15432:(e,s,a)=>{Promise.resolve().then(a.bind(a,52857))},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22727:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>r});let r=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/tracking/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/tracking/page.tsx","default")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31158:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(62688).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},31421:e=>{"use strict";e.exports=require("node:child_process")},33873:e=>{"use strict";e.exports=require("path")},40228:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(62688).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},44028:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>o});var r=a(65239),t=a(48088),i=a(88170),n=a.n(i),c=a(30893),l={};for(let e in c)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>c[e]);a.d(s,l);let o={children:["",{children:["admin",{children:["dashboard",{children:["tracking",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,22727)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/tracking/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,71232)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,99111)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/layout.tsx"],error:[()=>Promise.resolve().then(a.bind(a,54431)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,54413)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/tracking/page.tsx"],x={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/admin/dashboard/tracking/page",pathname:"/admin/dashboard/tracking",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},48161:e=>{"use strict";e.exports=require("node:os")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},52857:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>h});var r=a(60687),t=a(43210),i=a(78122),n=a(31158),c=a(99270),l=a(58869),o=a(40228),d=a(97992),x=a(13861),m=a(29523);function h(){let[e,s]=(0,t.useState)([]),[a,h]=(0,t.useState)([]),[p,u]=(0,t.useState)(!0),[g,v]=(0,t.useState)("activities"),[f,j]=(0,t.useState)(""),[y,b]=(0,t.useState)("7"),N=async()=>{u(!0);try{let[e,a]=await Promise.all([fetch(`/api/admin/tracking/activities?days=${y}`),fetch(`/api/admin/tracking/pageviews?days=${y}`)]);if(e.ok){let a=await e.json();s(a.activities)}if(a.ok){let e=await a.json();h(e.pageViews)}}catch(e){console.error("Error fetching tracking data:",e)}finally{u(!1)}},w=e.filter(e=>e.action.toLowerCase().includes(f.toLowerCase())||e.user?.email.toLowerCase().includes(f.toLowerCase())||e.resource?.toLowerCase().includes(f.toLowerCase())),k=a.filter(e=>e.path.toLowerCase().includes(f.toLowerCase())||e.ipAddress?.toLowerCase().includes(f.toLowerCase())),A=e=>{switch(e){case"USER_LOGIN":return"bg-green-100 text-green-800";case"USER_REGISTER":return"bg-blue-100 text-blue-800";case"PROPERTY_VIEW":return"bg-purple-100 text-purple-800";case"PROPERTY_SEARCH":return"bg-yellow-100 text-yellow-800";case"EMAIL_SUBSCRIBE":return"bg-pink-100 text-pink-800";case"PROPERTY_INQUIRY":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=e=>e?e.includes("Chrome")?"Chrome":e.includes("Firefox")?"Firefox":e.includes("Safari")?"Safari":e.includes("Edge")?"Edge":"Other":"Unknown";return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Tracking"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Monitor user activities and page views in real-time"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)(m.$,{onClick:N,variant:"outline",size:"sm",children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,r.jsxs)(m.$,{variant:"outline",size:"sm",children:[(0,r.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search activities, users, or resources...",value:f,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"})]})}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("select",{value:y,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",children:[(0,r.jsx)("option",{value:"1",children:"Last 24 hours"}),(0,r.jsx)("option",{value:"7",children:"Last 7 days"}),(0,r.jsx)("option",{value:"30",children:"Last 30 days"}),(0,r.jsx)("option",{value:"90",children:"Last 90 days"})]})})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsxs)("nav",{className:"flex space-x-8 px-6",children:[(0,r.jsxs)("button",{onClick:()=>v("activities"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"activities"===g?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["User Activities (",w.length,")"]}),(0,r.jsxs)("button",{onClick:()=>v("pageviews"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"pageviews"===g?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Page Views (",k.length,")"]})]})}),(0,r.jsx)("div",{className:"p-6",children:p?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):(0,r.jsxs)(r.Fragment,{children:["activities"===g&&(0,r.jsx)("div",{className:"space-y-4",children:w.length>0?w.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsx)("div",{className:"flex items-start justify-between",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(l.A,{className:"w-5 h-5 text-gray-600"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${A(e.action)}`,children:e.action.replace("_"," ")}),e.resource&&(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["â†’ ",e.resource]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:e.user?(0,r.jsx)("span",{className:"font-medium",children:e.user.name||e.user.email}):(0,r.jsx)("span",{className:"text-gray-500",children:"Anonymous user"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(o.A,{className:"w-3 h-3 mr-1"}),new Date(e.createdAt).toLocaleString()]}),(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-3 h-3 mr-1"}),e.ipAddress||"Unknown IP"]}),(0,r.jsx)("span",{children:P(e.userAgent)})]})]})]})}),e.metadata&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:(0,r.jsx)("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(JSON.parse(e.metadata),null,2)})})]},e.id)):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(x.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No activities found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No user activities match your current filters."})]})}),"pageviews"===g&&(0,r.jsx)("div",{className:"space-y-4",children:k.length>0?k.map(e=>(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"w-5 h-5 text-blue-600"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.path}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(o.A,{className:"w-3 h-3 mr-1"}),new Date(e.createdAt).toLocaleString()]}),(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"w-3 h-3 mr-1"}),e.ipAddress||"Unknown IP"]}),(0,r.jsx)("span",{children:P(e.userAgent)})]}),e.referrer&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Referrer: ",e.referrer]})]})]})},e.id)):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(x.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No page views found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No page views match your current filters."})]})})]})})]})]})}},55511:e=>{"use strict";e.exports=require("crypto")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{"use strict";e.exports=require("node:fs")},76760:e=>{"use strict";e.exports=require("node:path")},77598:e=>{"use strict";e.exports=require("node:crypto")},78474:e=>{"use strict";e.exports=require("node:events")},79551:e=>{"use strict";e.exports=require("url")}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[4243,2404,7182,8595],()=>a(44028));module.exports=r})();