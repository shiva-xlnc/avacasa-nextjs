(()=>{var e={};e.id=9650,e.ids=[9650],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:e=>{"use strict";e.exports=require("node:tty")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22474:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var t=a(65239),r=a(48088),i=a(88170),n=a.n(i),o=a(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(s,l);let c={children:["",{children:["admin",{children:["dashboard",{children:["locations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,79036)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/locations/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,71232)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,99111)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/layout.tsx"],error:[()=>Promise.resolve().then(a.bind(a,54431)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,54413)),"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/locations/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/dashboard/locations/page",pathname:"/admin/dashboard/locations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31421:e=>{"use strict";e.exports=require("node:child_process")},33873:e=>{"use strict";e.exports=require("path")},48161:e=>{"use strict";e.exports=require("node:os")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},54579:(e,s,a)=>{Promise.resolve().then(a.bind(a,68866))},55511:e=>{"use strict";e.exports=require("crypto")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63143:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},68866:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>y});var t=a(60687),r=a(43210),i=a(96474),n=a(99270),o=a(64398),l=a(32192),c=a(13861),d=a(63143),u=a(88233),h=a(97992),m=a(11860),x=a(29523),p=a(85814),g=a.n(p);function y(){let[e,s]=(0,r.useState)([]),[a,m]=(0,r.useState)(!0),[p,y]=(0,r.useState)(""),[v,b]=(0,r.useState)(!1),[j,N]=(0,r.useState)(null),[k,w]=(0,r.useState)(!1),A=async()=>{m(!0);try{let e=await fetch("/api/admin/locations");if(e.ok){let a=(await e.json()).locations.map(e=>({...e,highlights:e.highlights||"[]"}));s(a)}}catch(e){console.error("Error fetching locations:",e)}finally{m(!1)}},C=async()=>{w(!0);try{let e=await fetch("/api/admin/locations/update-counts",{method:"POST"});if(e.ok){let s=await e.json();console.log("Property counts updated:",s.results),A(),alert("Property counts updated successfully!")}else alert("Failed to update property counts")}catch(e){console.error("Error updating property counts:",e),alert("Error updating property counts")}finally{w(!1)}},P=async a=>{if(confirm("Are you sure you want to delete this location?"))try{(await fetch(`/api/admin/locations/${a}`,{method:"DELETE"})).ok&&s(e.filter(e=>e.id!==a))}catch(e){console.error("Error deleting location:",e)}},q=async(a,t)=>{try{(await fetch(`/api/admin/locations/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({featured:!t})})).ok&&s(e.map(e=>e.id===a?{...e,featured:!t}:e))}catch(e){console.error("Error updating location:",e)}},S=e.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.description.toLowerCase().includes(p.toLowerCase()));return a?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Locations Management"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage all locations in your system"})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(x.$,{onClick:C,disabled:k,variant:"outline",className:"border-gray-300",children:k?"Updating...":"Update Counts"}),(0,t.jsxs)(x.$,{onClick:()=>b(!0),className:"bg-gray-900 hover:bg-gray-800",children:[(0,t.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"relative max-w-md",children:[(0,t.jsx)(n.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)("input",{type:"text",placeholder:"Search locations...",value:p,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,t.jsxs)("div",{className:"relative h-48",children:[(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"}),e.featured&&(0,t.jsx)("div",{className:"absolute top-2 left-2",children:(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[(0,t.jsx)(o.A,{className:"w-3 h-3 mr-1"}),"Featured"]})})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,t.jsx)(l.A,{className:"w-4 h-4 mr-1"}),e.propertyCount]})]}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(g(),{href:`/locations/${e.slug}`,target:"_blank",className:"text-blue-600 hover:text-blue-900",children:(0,t.jsx)(c.A,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>q(e.id,e.featured),className:`${e.featured?"text-yellow-600":"text-gray-400"} hover:text-yellow-700`,title:e.featured?"Remove from featured":"Add to featured",children:(0,t.jsx)(o.A,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>N(e),className:"text-gray-600 hover:text-gray-900",children:(0,t.jsx)(d.A,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>P(e.id),className:"text-red-600 hover:text-red-900",children:(0,t.jsx)(u.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${e.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.active?"Active":"Inactive"})]})]})]},e.id))}),0===S.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(h.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No locations found"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new location."}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsxs)(x.$,{onClick:()=>b(!0),className:"bg-gray-900 hover:bg-gray-800",children:[(0,t.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Add Location"]})})]}),(v||j)&&(0,t.jsx)(f,{location:j,onClose:()=>{b(!1),N(null)},onSave:()=>{A(),b(!1),N(null)}})]})}function f({location:e,onClose:s,onSave:a}){let[n,o]=(0,r.useState)({name:e?.name||"",description:e?.description||"",image:e?.image||"",featured:e?.featured||!1,active:e?.active??!0}),[l,c]=(0,r.useState)(e?JSON.parse(e.highlights||"[]"):[]),[d,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),g=()=>{d.trim()&&!l.includes(d.trim())&&(c([...l,d.trim()]),u(""))},y=e=>{c(l.filter((s,a)=>a!==e))},f=async s=>{s.preventDefault(),p(!0);try{let s=e?`/api/admin/locations/${e.id}`:"/api/admin/locations",t=e?"PATCH":"POST";(await fetch(s,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,highlights:l,slug:n.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")})})).ok&&a()}catch(e){console.error("Error saving location:",e)}finally{p(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:e?"Edit Location":"Add New Location"}),(0,t.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,t.jsx)("input",{type:"text",value:n.name,onChange:e=>o({...n,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image URL *"}),(0,t.jsx)("input",{type:"url",value:n.image,onChange:e=>o({...n,image:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,t.jsx)("textarea",{value:n.description,onChange:e=>o({...n,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:"Describe what makes this location special...",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What makes this location special?"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),g()),placeholder:"e.g., Pristine Beaches, Coffee Plantations...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"}),(0,t.jsx)(x.$,{type:"button",onClick:g,disabled:!d.trim(),className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white rounded-lg disabled:opacity-50",children:(0,t.jsx)(i.A,{className:"w-4 h-4"})})]}),l.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Current highlights:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:l.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-1 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("button",{type:"button",onClick:()=>y(s),className:"text-blue-600 hover:text-blue-800 ml-1",children:(0,t.jsx)(m.A,{className:"w-3 h-3"})})]},s))})]}),0===l.length&&(0,t.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Add highlights to showcase what makes this location unique"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:n.featured,onChange:e=>o({...n,featured:e.target.checked}),className:"mr-2 rounded"}),(0,t.jsx)("span",{className:"text-sm",children:"Featured Location"})]}),(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:n.active,onChange:e=>o({...n,active:e.target.checked}),className:"mr-2 rounded"}),(0,t.jsx)("span",{className:"text-sm",children:"Active"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,t.jsx)(x.$,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),(0,t.jsx)(x.$,{type:"submit",disabled:h,className:"bg-gray-900 hover:bg-gray-800",children:h?"Saving...":e?"Update Location":"Create Location"})]})]})]})})}},73024:e=>{"use strict";e.exports=require("node:fs")},76760:e=>{"use strict";e.exports=require("node:path")},77598:e=>{"use strict";e.exports=require("node:crypto")},78474:e=>{"use strict";e.exports=require("node:events")},79036:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/locations/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/akashsharma/AkashDocs/avacasa/avacasa-nextjs/src/app/admin/dashboard/locations/page.tsx","default")},79551:e=>{"use strict";e.exports=require("url")},88233:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},94491:(e,s,a)=>{Promise.resolve().then(a.bind(a,79036))},96474:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[4243,2404,7182,8595],()=>a(22474));module.exports=t})();