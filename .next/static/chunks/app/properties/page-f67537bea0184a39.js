(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7754],{279:(e,t,r)=>{Promise.resolve().then(r.bind(r,7190))},2575:(e,t,r)=>{"use strict";r.d(t,{o:()=>y});var a=r(5155),n=r(2115),l=r(4516),s=r(7340),o=r(8957),i=r(8979),c=r(8136),d=r(1154),p=r(4416),u=r(7924),m=r(285),h=r(5695);let g={"map-pin":l.A,home:s.A,tree:o.A,square:i.A,building:c.A};function y(e){let{placeholder:t="Search property type, location, or keyword...",className:r="",onSearch:l,showPropertyType:o=!0,variant:i="hero"}=e,[c,y]=(0,n.useState)(""),[f,x]=(0,n.useState)([]),[w,b]=(0,n.useState)(!1),[v,N]=(0,n.useState)(!1),[j,A]=(0,n.useState)(-1),[T,E]=(0,n.useState)(""),k=(0,n.useRef)(null),S=(0,n.useRef)(null),L=(0,n.useRef)(null),R=(0,n.useRef)(null),C=(0,n.useRef)(null),O=(0,h.useRouter)(),P=(0,n.useCallback)(async e=>{if(!e.trim()||e.length<2){x([]),b(!1);return}C.current&&C.current.abort(),C.current=new AbortController;try{b(!0);let t=await fetch("/api/search/suggestions?q=".concat(encodeURIComponent(e),"&limit=8"),{signal:C.current.signal});if(t.ok){let e=await t.json();e.success&&(x(e.data),N(!0))}}catch(e){e instanceof Error&&"AbortError"!==e.name&&console.error("Search suggestions error:",e)}finally{b(!1)}},[]),_=e=>{y(e),A(-1),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{P(e)},300)},I=e=>{y(e.value),N(!1),A(-1),"location"===e.type&&e.slug?O.push("/locations/".concat(e.slug)):"property"===e.type&&e.slug?O.push("/properties/".concat(e.slug)):D(e.value,"property_type"===e.type?e.key:void 0)},D=(e,t)=>{let r=e||c;if(!r.trim())return;let a=new URLSearchParams;a.set("search",r),t?a.set("propertyType",t):T&&a.set("propertyType",T),l?l(r,{propertyType:t||T}):O.push("/properties?".concat(a.toString())),N(!1)};(0,n.useEffect)(()=>{let e=e=>{k.current&&!k.current.contains(e.target)&&(N(!1),A(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.useEffect)(()=>()=>{R.current&&clearTimeout(R.current),C.current&&C.current.abort()},[]);let U=e=>g[e]||s.A;return(0,a.jsxs)("div",{ref:k,className:"relative ".concat(r),children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),D()},className:"\n          ".concat("hero"===i?"bg-white/95 backdrop-blur-sm rounded-2xl sm:rounded-full p-3 sm:p-2 shadow-2xl":"header"===i?"flex gap-2":"bg-white rounded-lg shadow-sm border p-2","\n        "),children:(0,a.jsxs)("div",{className:"\n          flex items-stretch gap-3\n          ".concat("hero"===i?"flex-col lg:flex-row lg:gap-0":"flex-row","\n        "),children:[(0,a.jsx)("div",{className:"\n            flex-1 relative\n            ".concat("hero"===i?"px-4 sm:px-6 py-3 lg:py-4 lg:border-r border-gray-200":"px-3 py-2","\n          "),children:(0,a.jsxs)("div",{className:"text-left",children:["hero"===i&&(0,a.jsx)("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"Property Type & Keyword"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{ref:S,type:"text",placeholder:t,value:c,onChange:e=>_(e.target.value),onKeyDown:e=>{if(v&&0!==f.length)switch(e.key){case"ArrowDown":e.preventDefault(),A(e=>e<f.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),A(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),j>=0?I(f[j]):D();break;case"Escape":var t;N(!1),A(-1),null==(t=S.current)||t.blur()}},onFocus:()=>{f.length>0&&N(!0)},className:"\n                    w-full bg-transparent border-0 focus:outline-none\n                    ".concat("hero"===i?"text-gray-900 placeholder-gray-500 text-sm lg:text-base":"text-gray-900 placeholder-gray-500 text-sm","\n                  ")}),w&&(0,a.jsx)(d.A,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 animate-spin text-gray-400"}),c&&!w&&(0,a.jsx)("button",{type:"button",onClick:()=>{var e;y(""),x([]),N(!1),null==(e=S.current)||e.focus()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(p.A,{className:"w-4 h-4"})})]})]})}),o&&"hero"===i&&(0,a.jsx)("div",{className:"px-4 sm:px-6 py-3 lg:py-4 min-w-0",children:(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"Property Type"}),(0,a.jsx)("select",{value:T,onChange:e=>E(e.target.value),className:"w-full bg-transparent border-0 focus:outline-none text-gray-900 text-sm lg:text-base",children:[{key:"",label:"All Properties"},{key:"VILLA",label:"Villas"},{key:"HOLIDAY_HOME",label:"Holiday Homes"},{key:"FARMLAND",label:"Farmlands"},{key:"PLOT",label:"Plots"},{key:"APARTMENT",label:"Apartments"}].map(e=>(0,a.jsx)("option",{value:e.key,children:e.label},e.key))})]})}),(0,a.jsx)("div",{className:"\n            ".concat("hero"===i?"lg:pl-3 lg:pr-2 lg:flex lg:items-center":"flex items-center","\n          "),children:(0,a.jsxs)(m.$,{type:"submit",className:"\n                ".concat("hero"===i?"w-full lg:w-auto h-12 lg:h-12 lg:w-12 rounded-xl lg:rounded-full bg-gray-900 hover:bg-gray-800 text-white shadow-lg transition-all duration-300 hover:scale-105 border-0 flex items-center justify-center gap-2 lg:gap-0":"header"===i?"h-10 px-4":"h-10 px-6","\n              "),children:[(0,a.jsx)(u.A,{className:"w-4 h-4"}),"hero"!==i&&(0,a.jsx)("span",{className:"ml-2",children:"Search"}),"hero"===i&&(0,a.jsx)("span",{className:"lg:hidden",children:"Search"})]})})]})}),v&&f.length>0&&(0,a.jsx)("div",{ref:L,className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-lg border border-gray-200 z-50 max-h-80 overflow-y-auto",children:f.map((e,t)=>{let r=U(e.icon);return(0,a.jsxs)("button",{type:"button",onClick:()=>I(e),className:"\n                  w-full px-4 py-3 text-left flex items-center gap-3 transition-colors duration-200\n                  ".concat(t===j?"bg-gray-100":"hover:bg-gray-50","\n                  ").concat(0===t?"rounded-t-xl":"","\n                  ").concat(t===f.length-1?"rounded-b-xl":"","\n                "),children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(r,{className:"w-4 h-4 text-gray-500"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.subtitle})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"\n                    text-xs px-2 py-1 rounded-full\n                    ".concat("location"===e.type?"bg-blue-100 text-blue-700":"property_type"===e.type?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700","\n                  "),children:"location"===e.type?"Location":"property_type"===e.type?"Type":"Property"})})]},"".concat(e.type,"-").concat(e.id))})})]})}},4643:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});var a=r(2115),n=r(7600),l=r(5695);let s=e=>{let t=new WeakSet,r=e=>{if(null==e||"object"!=typeof e)return e;if(e instanceof HTMLElement)return{tagName:e.tagName||"Unknown",id:e.id||void 0,className:e.className||void 0,type:"HTMLElement"};if(e instanceof Node)return{nodeType:e.nodeType,nodeName:e.nodeName||"Unknown",type:"Node"};if(e instanceof Event)return{type:e.type,target:e.target?r(e.target):void 0,eventType:"Event"};if("function"==typeof e)return{type:"Function",name:e.name||"anonymous"};if(t.has(e))return{type:"CircularReference"};t.add(e);try{if(Array.isArray(e))return e.map(e=>r(e));if(e instanceof Date)return e.toISOString();if(e instanceof RegExp)return{type:"RegExp",source:e.source,flags:e.flags};if(e instanceof Error)return{type:"Error",name:e.name,message:e.message,stack:e.stack};let t={};for(let[a,n]of Object.entries(e))if(!(a.startsWith("__react")||a.startsWith("_react")||a.includes("Fiber")))try{t[a]=r(n)}catch(e){t[a]={type:"SerializationError",error:"Failed to serialize"}}return t}catch(e){return{type:"SerializationError",error:"Failed to serialize object"}}};return r(e)};function o(){let{user:e}=(0,n.A)(),t=(0,l.usePathname)(),r=(0,a.useRef)(Date.now()),o=(0,a.useRef)(0),i=(0,a.useRef)(0),c=(0,a.useCallback)(async(t,r,a)=>{try{let n=s({...a,userId:null==e?void 0:e.id,userEmail:null==e?void 0:e.email,page:window.location.pathname,url:window.location.href,timestamp:new Date().toISOString(),sessionId:d()});await fetch("/api/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,resource:r,metadata:n})})}catch(e){console.error("Tracking failed:",e)}},[e]),d=(0,a.useCallback)(()=>{let e=sessionStorage.getItem("tracking-session-id");return e||(e="sess_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),sessionStorage.setItem("tracking-session-id",e)),e},[]),p=(0,a.useCallback)(e=>{let t=e||window.location.pathname;r.current=Date.now(),o.current=0,c("PAGE_VIEW",t,{title:document.title,referrer:document.referrer,userAgent:navigator.userAgent,screenResolution:"".concat(screen.width,"x").concat(screen.height),viewportSize:"".concat(window.innerWidth,"x").concat(window.innerHeight),language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})},[c]),u=(0,a.useCallback)(e=>{let t=Date.now()-r.current;c("PAGE_EXIT",e||window.location.pathname,{timeSpent:t,maxScrollDepth:o.current,exitType:"navigation"})},[c]),m=(0,a.useCallback)(()=>{let e=Math.round((window.pageYOffset||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-window.innerHeight)*100);e>o.current&&(o.current=e,e>=25&&i.current<25?c("SCROLL_DEPTH",window.location.pathname,{depth:25}):e>=50&&i.current<50?c("SCROLL_DEPTH",window.location.pathname,{depth:50}):e>=75&&i.current<75?c("SCROLL_DEPTH",window.location.pathname,{depth:75}):e>=90&&i.current<90&&c("SCROLL_DEPTH",window.location.pathname,{depth:90}),i.current=e)},[c]),h=(0,a.useCallback)((e,t)=>{c("PROPERTY_VIEW",e,{propertyTitle:t,viewStartTime:Date.now()})},[c]),g=(0,a.useCallback)((e,t)=>{c("PROPERTY_INQUIRY",e,{inquiryType:t,conversionPath:k()})},[c]),y=(0,a.useCallback)((e,t,r)=>{c("PROPERTY_SEARCH",void 0,{query:e,filters:t,results:r,searchTime:Date.now()})},[c]),f=(0,a.useCallback)((e,t)=>{c("LOCATION_VIEW",e,{locationName:t})},[c]),x=(0,a.useCallback)((e,t)=>{c("BLOG_VIEW",e,{blogTitle:t})},[c]),w=(0,a.useCallback)((e,t)=>{c("DOWNLOAD",e,{fileName:t,downloadSource:window.location.pathname})},[c]),b=(0,a.useCallback)((e,t)=>{c("CONTACT_SUBMIT",e,{...t,conversionPath:k()})},[c]),v=(0,a.useCallback)((e,t)=>{c("BUTTON_CLICK",e,{location:t,page:window.location.pathname})},[c]),N=(0,a.useCallback)(e=>{c("FORM_START",e,{page:window.location.pathname})},[c]),j=(0,a.useCallback)((e,t)=>{c("FORM_COMPLETE",e,{success:t,page:window.location.pathname})},[c]),A=(0,a.useCallback)(e=>{c("USER_REGISTER",e,{registrationSource:window.location.pathname})},[c]),T=(0,a.useCallback)(e=>{c("USER_LOGIN",e,{loginSource:window.location.pathname})},[c]),E=(0,a.useCallback)(e=>{c("EMAIL_SUBSCRIBE",e,{subscriptionSource:window.location.pathname})},[c]),k=(0,a.useCallback)(()=>{let e=sessionStorage.getItem("user-journey")||"[]";try{return JSON.parse(e)}catch(e){return[]}},[]),S=(0,a.useCallback)(e=>{let t=k();t.push({page:e,timestamp:Date.now(),title:document.title}),t.length>20&&t.shift(),sessionStorage.setItem("user-journey",JSON.stringify(t))},[k]);return(0,a.useEffect)(()=>{p(),S(t);let e=()=>m();window.addEventListener("scroll",e,{passive:!0});let r=()=>u();return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("scroll",e),window.removeEventListener("beforeunload",r),u()}},[t,p,u,m,S]),{track:c,trackPageView:p,trackPageExit:u,trackScrollDepth:m,trackPropertyView:h,trackPropertyInquiry:g,trackSearch:y,trackLocationView:f,trackBlogView:x,trackDownload:w,trackContact:b,trackButtonClick:v,trackFormStart:N,trackFormComplete:j,trackUserRegistration:A,trackUserLogin:T,trackEmailSubscribe:E,getConversionPath:k}}},6098:(e,t,r)=>{"use strict";r.d(t,{Ut:()=>a});var a=function(e){return e.HOLIDAY_HOME="HOLIDAY_HOME",e.FARMLAND="FARMLAND",e.PLOT="PLOT",e.VILLA="VILLA",e.APARTMENT="APARTMENT",e}({})},7190:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x,dynamic:()=>f});var a=r(5155),n=r(2115),l=r(5695),s=r(4552),o=r(285),i=r(4653),c=r(3578),d=r(7340),p=r(6098),u=r(5028),m=r(4643),h=r(2575);let g=(0,u.default)(()=>Promise.all([r.e(9484),r.e(1761),r.e(8964)]).then(r.bind(r,8964)),{loadableGenerated:{webpack:()=>[8964]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"h-full bg-gray-100 animate-pulse rounded-lg"})});function y(){let[e,t]=(0,n.useState)([]),[r,u]=(0,n.useState)(!0),[y,f]=(0,n.useState)(!1),[x,w]=(0,n.useState)({page:1,limit:12}),b=(0,l.useSearchParams)(),v=(0,l.useRouter)(),N=(0,l.usePathname)(),{trackPageView:j,trackSearch:A}=(0,m.z)();(0,n.useEffect)(()=>{let e={page:1,limit:12},t=b.get("type")||b.get("propertyType");if(t){let r={villa:p.Ut.VILLA,villas:p.Ut.VILLA,"holiday-home":p.Ut.HOLIDAY_HOME,"holiday-homes":p.Ut.HOLIDAY_HOME,farmland:p.Ut.FARMLAND,farmlands:p.Ut.FARMLAND,plot:p.Ut.PLOT,plots:p.Ut.PLOT,apartment:p.Ut.APARTMENT,apartments:p.Ut.APARTMENT}[t.toLowerCase()];r&&(e.propertyType=r)}let r=b.get("search");r&&(e.search=r);let a=b.get("featured");"true"===a?e.featured=!0:"false"===a&&(e.featured=!1);let n=b.get("location");n&&(e.search=n),w(e)},[b]),(0,n.useEffect)(()=>{j("/properties")},[j]),(0,n.useEffect)(()=>{T()},[x]);let T=async()=>{u(!0);try{let e=new URLSearchParams;x.search&&e.append("search",x.search),x.propertyType&&e.append("propertyType",x.propertyType),void 0!==x.featured&&e.append("featured",x.featured.toString()),x.page&&e.append("page",x.page.toString()),x.limit&&e.append("limit",x.limit.toString());let r=await fetch("/api/properties?".concat(e.toString()));if(r.ok){let e=await r.json();e.success&&t(e.data)}}catch(e){console.error("Error fetching properties:",e)}finally{u(!1)}},E=e=>{let t={...x,...e};w(t),k(t),A("",{...t,source:"filter_change"})},k=e=>{let t=new URLSearchParams;if(e.search&&t.set("search",e.search),e.propertyType){let r={[p.Ut.VILLA]:"villa",[p.Ut.HOLIDAY_HOME]:"holiday-home",[p.Ut.FARMLAND]:"farmland",[p.Ut.PLOT]:"plot",[p.Ut.APARTMENT]:"apartment"};t.set("type",r[e.propertyType])}void 0!==e.featured&&t.set("featured",e.featured.toString());let r=t.toString()?"".concat(N,"?").concat(t.toString()):N;v.replace(r,{scroll:!1})};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 ",children:[(0,a.jsx)("div",{className:"bg-gray-50 border-b  top-16 z-40 mt-30",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,a.jsx)("div",{className:"flex-1 max-w-2xl",children:(0,a.jsx)(h.o,{variant:"page",placeholder:"Search by property type, location, or keyword...",onSearch:(e,t)=>{let r={...x,search:e,propertyType:null==t?void 0:t.propertyType,page:1};w(r),k(r),A(e,{propertyType:null==t?void 0:t.propertyType,source:"properties_page"})},showPropertyType:!1,className:"w-full"})}),(0,a.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>f(!y),children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Hide Map"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Show Map"]})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(o.$,{variant:void 0!==x.featured||x.propertyType?"outline":"default",size:"sm",onClick:()=>E({featured:void 0,propertyType:void 0}),children:"All Properties"}),(0,a.jsx)(o.$,{variant:!0===x.featured?"default":"outline",size:"sm",onClick:()=>E({featured:!0}),children:"Featured"}),(0,a.jsx)(o.$,{variant:x.propertyType===p.Ut.VILLA?"default":"outline",size:"sm",onClick:()=>E({propertyType:p.Ut.VILLA}),children:"Villas"}),(0,a.jsx)(o.$,{variant:x.propertyType===p.Ut.HOLIDAY_HOME?"default":"outline",size:"sm",onClick:()=>E({propertyType:p.Ut.HOLIDAY_HOME}),children:"Holiday Homes"}),(0,a.jsx)(o.$,{variant:x.propertyType===p.Ut.FARMLAND?"default":"outline",size:"sm",onClick:()=>E({propertyType:p.Ut.FARMLAND}),children:"Farmlands"})]})]})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:[x.search?'Search Results for "'.concat(x.search,'"'):"All Properties",(0,a.jsxs)("span",{className:"text-gray-500 font-normal ml-2",children:["(",e.length," properties)"]})]})}),(0,a.jsxs)("div",{className:"flex gap-8",children:[(0,a.jsx)("div",{className:"".concat(y?"lg:w-1/2":"w-full"," transition-all duration-300"),children:r?(0,a.jsx)("div",{className:"grid grid-cols-1 ".concat(y?"md:grid-cols-1 lg:grid-cols-2":"md:grid-cols-2 lg:grid-cols-3"," gap-6"),children:[...Array(6)].map((e,t)=>(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm h-96 animate-pulse"},t))}):e.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 ".concat(y?"md:grid-cols-1 lg:grid-cols-2":"md:grid-cols-2 lg:grid-cols-3"," gap-6"),children:e.map(e=>(0,a.jsx)(s.y,{property:e},e.id))}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(d.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No properties found"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or browse all properties."}),(0,a.jsx)(o.$,{onClick:()=>{let e={page:1,limit:12};w(e),k(e)},children:"View All Properties"})]})}),y&&(0,a.jsx)("div",{className:"lg:w-1/2",children:(0,a.jsx)("div",{className:"sticky top-24 h-[600px] rounded-lg overflow-hidden shadow-lg",children:(0,a.jsx)(g,{properties:e})})})]})]})]})}let f="force-dynamic";function x(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:"Loading..."}),children:(0,a.jsx)(y,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3455,6874,3063,1095,4552,8441,1684,7358],()=>t(279)),_N_E=e.O()}]);